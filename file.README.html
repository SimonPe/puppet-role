<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.20
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="puppet_class_list_link"
        href="puppet_class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'><h1>role</h1>

<h4>Table of Contents</h4>

<ul>
<li><a href="#label-Introduction">Introduction</a></li>
<li><a href="#label-Setup">Setup</a>

<ul>
<li><a href="#label-Setup+requirements">Setup Requirements</a></li>
<li><a href="#label-Quickstart">Quickstart</a></li>
</ul></li>
<li><a href="#label-Usage">Usage</a>

<ul>
<li><a href="#label-Resolve_order">resolve_order</a></li>
<li><a href="#label-Search_namespaces">search_namespaces</a></li>
</ul></li>
<li><a href="#label-Notes">Notes</a>

<ul>
<li><a href="#label-Windows+users">Windows Users</a></li>
<li><a href="#label-Trusted+facts">Trusted facts</a></li>
</ul></li>
<li><a href="#label-Development">Development</a></li>
</ul>

<h2>Introduction</h2>

<p>This module aims to abstract resolving the correct role for your
machine. It supports several ways to figure out the role:</p>

<ul>
<li>Use trusted facts</li>
<li>Use facts</li>
<li>Use a parameter (allows configuration through hiera)</li>
<li>Use a custom function</li>
<li>Fallback to a default</li>
<li>or Fail if there is no role found.</li>
</ul>

<p>It also allows setting up a waterfall mechanism: no trusted fact? how
about a regular one? a param?</p>

<h2>Setup</h2>

<h3>Setup Requirements</h3>

<p>Depending on how you want to use this module, you will need to learn
about:</p>

<ul>
<li>hiera</li>
<li>trusted facts</li>
<li>(custom) facts</li>
<li>writing functions</li>
</ul>

<p>On a puppet side: we depend on the stdlib module for additional
functions.</p>

<h3>Quickstart</h3>

<p>Include role in your (default) node.</p>

<p><code>manifests/site.pp</code>:</p>

<pre class="code puppet"><code class="puppet">node &#39;default&#39; {
  include ::role
}
</code></pre>

<p>Configure the namespace to use in hiera:</p>

<p><code>hiera/common.yaml</code>:</p>

<pre class="code yaml"><code class="yaml">---
role::namespace: &#39;::my_roles&#39;
</code></pre>

<h2>Usage:</h2>

<h3>resolve_order</h3>

<p>Using the resolve order.</p>

<pre class="code yaml"><code class="yaml">---
role::namespace: &#39;::my_roles&#39;
role::resolve_order:
  - trusted
  - fact
  - param
  - default
</code></pre>

<p>Load a base profile directly as default role:</p>

<pre class="code yaml"><code class="yaml">---
role::default_namespace: &#39;&#39;
role::default_separator: &#39;&#39;
role::default_role: profile_base
</code></pre>

<p>Enforce setting up a role using trusted facts or fail the puppet run:</p>

<pre class="code yaml"><code class="yaml">role::resolve_order:
  - trusted
  - fail
</code></pre>

<h3>search_namespaces</h3>

<p>It is possible to search for a role in multiple namespaces. To do this,
supply an (non-empty) array with namespaces to look in.</p>

<p>By example:</p>

<pre class="code yaml"><code class="yaml">role::separator: &#39;::&#39;
role::search_namespaces:
  - shared_roles
  - my_roles
  - {&#39;&#39;: &#39;&#39;}
  - {customer: &#39;_&#39;}
</code></pre>

<p>The module will attempt to find the following classes (in order) for
role <code>foobar</code> and use the first one that exists.</p>

<ul>
<li>shared_roles::foobar</li>
<li>my_roles::foobar</li>
<li>foobar</li>
<li>customer_foobar</li>
</ul>

<p><strong>Note</strong>: A namespace parameter will always take precedence. In hiera,
you can force a <code>undef</code> or <code>nil</code> value using <code>~</code>.</p>

<pre class="code yaml"><code class="yaml">role::namespace: ~
role::search_namespaces:
 - &#39;&#39;
 - {&#39;my_roles&#39;: &#39;::&#39;}

</code></pre>

<h2>Notes</h2>

<h3>Windows Users</h3>

<p>When you have (puppet) developers that work on Windows workstations, you
should prevent using <code>::</code> (double colons) in your role names. Using such
a role (<code>foo::bar</code>) in combination with hiera could result in filenames
with <code>::</code> in them. This will effectivly prevent any Windows user from
checking out the repository.</p>

<p>In stead, you can choose any other separator (<code>__</code> for example) and
remap the role to a class name using <code>translate_role_callback</code>. For role
<code>foo__bar</code>, the following example would result in <code>myspace::foo::bar</code>
being included.</p>

<pre class="code yaml"><code class="yaml">role::namespace: &#39;myspace&#39;
role::translate_role_callback: &#39;role::translate_double_underscores&#39;
</code></pre>

<h3>Trusted facts</h3>

<p>If you intend to use trusted facts as classification for your roles,
take the following remarks into account:</p>

<ul>
<li>Do not use <code>trusted</code> in combination with facts in the <code>resolve_order</code>:
Facts can easily be overridden on the agent side.</li>
<li>Your hiera hierarchy should not use anything besides trusted facts.
Same reason applies.</li>
</ul>

<h2>Development</h2>
</div></div>

      <div id="footer">
     Generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>.
</div>

    </div>
  </body>
</html>